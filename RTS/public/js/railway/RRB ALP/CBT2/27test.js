const questions =[
    {
"num": 1,
"question_en": "In the word 'CONGRATULATIONS', which letter is 7th from the left?",
"question_hi": "'CONGRATULATIONS' शब्द में बाएं से 7वां अक्षर क्या है?",
"options_en": ["T", "U", "L", "A"],
"options_hi": ["T", "U", "L", "A"],
"answer_en": "T",
"answer_hi": "T"
},
{
"num": 2,
"question_en": "What is the sum of 1st and 4th numbers in: 7, 14, 21, 28, 35?",
"question_hi": "7, 14, 21, 28, 35 में पहली और चौथी संख्या का योग क्या है?",
"options_en": ["35", "42", "28", "21"],
"options_hi": ["35", "42", "28", "21"],
"answer_en": "35",
"answer_hi": "35"
},
{
"num": 3,
"question_en": "In the pattern: M1, N2, O3, P4, what comes next?",
"question_hi": "पैटर्न: M1, N2, O3, P4 में, आगे क्या आता है?",
"options_en": ["Q5", "R6", "Q6", "P5"],
"options_hi": ["Q5", "R6", "Q6", "P5"],
"answer_en": "Q5",
"answer_hi": "Q5"
},
{
"num": 4,
"question_en": "Which number is exactly between 12 and 24 in: 6, 12, 18, 24, 30?",
"question_hi": "6, 12, 18, 24, 30 में 12 और 24 के ठीक बीच में कौन सी संख्या है?",
"options_en": ["18", "12", "24", "6"],
"options_hi": ["18", "12", "24", "6"],
"answer_en": "18",
"answer_hi": "18"
},
{
"num": 5,
"question_en": "In 'IRRITATION', what is the position of the third 'I' from the left?",
"question_hi": "'IRRITATION' में, बाएं से तीसरे 'I' की स्थिति क्या है?",
"options_en": ["7", "6", "8", "9"],
"options_hi": ["7", "6", "8", "9"],
"answer_en": "7",
"answer_hi": "7"
},
{
"num": 6,
"question_en": "What is the product of 2nd and 3rd odd numbers starting from 3?",
"question_hi": "3 से शुरू होने वाली दूसरी और तीसरी विषम संख्याओं का गुणनफल क्या है?",
"options_en": ["35", "21", "45", "63"],
"options_hi": ["35", "21", "45", "63"],
"answer_en": "35",
"answer_hi": "35"
},
{
"num": 7,
"question_en": "In the series: 0.01, 0.02, 0.03, 0.04, 0.05, what is the 4th number multiplied by 100?",
"question_hi": "श्रृंखला: 0.01, 0.02, 0.03, 0.04, 0.05 में, चौथी संख्या को 100 से गुणा करने पर क्या मिलता है?",
"options_en": ["4", "3", "5", "2"],
"options_hi": ["4", "3", "5", "2"],
"answer_en": "4",
"answer_hi": "4"
},
{
"num": 8,
"question_en": "What is the difference between 5th and 2nd multiples of 13: 13, 26, 39, 52, 65?",
"question_hi": "13 के पांचवें और दूसरे गुणजों में अंतर: 13, 26, 39, 52, 65 क्या है?",
"options_en": ["39", "26", "52", "13"],
"options_hi": ["39", "26", "52", "13"],
"answer_en": "39",
"answer_hi": "39"
},
{
"num": 9,
"question_en": "In the word 'POSSESSION', which letter appears 3rd time?",
"question_hi": "'POSSESSION' शब्द में, कौन सा अक्षर तीसरी बार आता है?",
"options_en": ["S", "O", "P", "I"],
"options_hi": ["S", "O", "P", "I"],
"answer_en": "S",
"answer_hi": "S"
},
{
"num": 10,
"question_en": "What is the average of 4th and 5th square numbers: 1, 4, 9, 16, 25?",
"question_hi": "चौथी और पांचवीं वर्ग संख्याओं का औसत: 1, 4, 9, 16, 25 क्या है?",
"options_en": ["20.5", "20", "21", "19.5"],
"options_hi": ["20.5", "20", "21", "19.5"],
"answer_en": "20.5",
"answer_hi": "20.5"
},
{
"num": 11,
"question_en": "In the pattern: Z26, Y25, X24, W23, what comes next?",
"question_hi": "पैटर्न: Z26, Y25, X24, W23 में, आगे क्या आता है?",
"options_en": ["V22", "U21", "V21", "W22"],
"options_hi": ["V22", "U21", "V21", "W22"],
"answer_en": "V22",
"answer_hi": "V22"
},
{
"num": 12,
"question_en": "What is the sum of positions of 'O' in 'COMMONWEALTH'?",
"question_hi": "'COMMONWEALTH' में 'O' की स्थितियों का योग क्या है?",
"options_en": ["10", "9", "11", "12"],
"options_hi": ["10", "9", "11", "12"],
"answer_en": "10",
"answer_hi": "10"
},
{
"num": 13,
"question_en": "In the sequence: 5/10, 6/11, 7/12, 8/13, what comes next?",
"question_hi": "अनुक्रम: 5/10, 6/11, 7/12, 8/13 में, आगे क्या आता है?",
"options_en": ["9/14", "10/15", "9/15", "8/14"],
"options_hi": ["9/14", "10/15", "9/15", "8/14"],
"answer_en": "9/14",
"answer_hi": "9/14"
},
{
"num": 14,
"question_en": "What is the middle vowel in 'AUTHENTICATION'?",
"question_hi": "'AUTHENTICATION' में मध्य स्वर क्या है?",
"options_en": ["E", "I", "A", "U"],
"options_hi": ["E", "I", "A", "U"],
"answer_en": "E",
"answer_hi": "E"
},
{
"num": 15,
"question_en": "In the series: 6, 12, 18, 24, 30, what is 150% of 3rd number?",
"question_hi": "श्रृंखला: 6, 12, 18, 24, 30 में, तीसरी संख्या का 150% क्या है?",
"options_en": ["27", "36", "30", "24"],
"options_hi": ["27", "36", "30", "24"],
"answer_en": "27",
"answer_hi": "27"
},
{
"num": 16,
"question_en": "Which letter is exactly between K and S in alphabet?",
"question_hi": "वर्णमाला में K और S के ठीक बीच में कौन सा अक्षर है?",
"options_en": ["O", "N", "P", "Q"],
"options_hi": ["O", "N", "P", "Q"],
"answer_en": "O",
"answer_hi": "O"
},
{
"num": 17,
"question_en": "What is the product of 3rd and 4th prime numbers after 30?",
"question_hi": "30 के बाद तीसरी और चौथी अभाज्य संख्याओं का गुणनफल क्या है?",
"options_en": ["1517", "1369", "1681", "1849"],
"options_hi": ["1517", "1369", "1681", "1849"],
"answer_en": "1517",
"answer_hi": "1517"
},
{
"num": 18,
"question_en": "In 'REPRESENTATION', how many letters between first and last 'E'?",
"question_hi": "'REPRESENTATION' में, पहले और अंतिम 'E' के बीच कितने अक्षर हैं?",
"options_en": ["10", "11", "9", "12"],
"options_hi": ["10", "11", "9", "12"],
"answer_en": "10",
"answer_hi": "10"
},
{
"num": 19,
"question_en": "What is the difference between 6th and 4th triangular numbers: 1, 3, 6, 10, 15, 21?",
"question_hi": "छठी और चौथी त्रिभुज संख्याओं में अंतर: 1, 3, 6, 10, 15, 21 क्या है?",
"options_en": ["11", "10", "12", "9"],
"options_hi": ["11", "10", "12", "9"],
"answer_en": "11",
"answer_hi": "11"
},
{
"num": 20,
"question_en": "In the pattern: 8, 16, 32, 64, what is the next number?",
"question_hi": "पैटर्न: 8, 16, 32, 64 में, अगली संख्या क्या है?",
"options_en": ["128", "96", "256", "512"],
"options_hi": ["128", "96", "256", "512"],
"answer_en": "128",
"answer_hi": "128"
},
{
"num": 21,
"question_en": "What is the sum of digits of 5th number in: 14, 23, 32, 41, 50?",
"question_hi": "14, 23, 32, 41, 50 में पांचवीं संख्या के अंकों का योग क्या है?",
"options_en": ["5", "6", "4", "7"],
"options_hi": ["5", "6", "4", "7"],
"answer_en": "5",
"answer_hi": "5"
},
{
"num": 22,
"question_en": "In the series: 2.5, 5.0, 7.5, 10.0, 12.5, what is the 2nd number?",
"question_hi": "श्रृंखला: 2.5, 5.0, 7.5, 10.0, 12.5 में, दूसरी संख्या क्या है?",
"options_en": ["5.0", "2.5", "7.5", "10.0"],
"options_hi": ["5.0", "2.5", "7.5", "10.0"],
"answer_en": "5.0",
"answer_hi": "5.0"
},
{
"num": 23,
"question_en": "What is the position of second 'A' in 'ANNUALIZATION'?",
"question_hi": "'ANNUALIZATION' में दूसरे 'A' की स्थिति क्या है?",
"options_en": ["8", "7", "9", "10"],
"options_hi": ["8", "7", "9", "10"],
"answer_en": "8",
"answer_hi": "8"
},
{
"num": 24,
"question_en": "In the pattern: 100, 81, 64, 49, what comes next?",
"question_hi": "पैटर्न: 100, 81, 64, 49 में, आगे क्या आता है?",
"options_en": ["36", "25", "16", "9"],
"options_hi": ["36", "25", "16", "9"],
"answer_en": "36",
"answer_hi": "36"
},
{
"num": 25,
"question_en": "What is the average of middle three multiples of 8?",
"question_hi": "8 के मध्य तीन गुणजों का औसत क्या है?",
"options_en": ["24", "16", "32", "20"],
"options_hi": ["24", "16", "32", "20"],
"answer_en": "24",
"answer_hi": "24"
},
{
"num": 26,
"question_en": "In 'SYNCHRONIZATION', which consonant appears 4th?",
"question_hi": "'SYNCHRONIZATION' में, कौन सा व्यंजन चौथा आता है?",
"options_en": ["R", "N", "C", "H"],
"options_hi": ["R", "N", "C", "H"],
"answer_en": "R",
"answer_hi": "R"
},
{
"num": 27,
"question_en": "What is the sum of 1st and 5th cubes: 1, 8, 27, 64, 125?",
"question_hi": "पहले और पांचवें घनों का योग: 1, 8, 27, 64, 125 क्या है?",
"options_en": ["126", "129", "91", "152"],
"options_hi": ["126", "129", "91", "152"],
"answer_en": "126",
"answer_hi": "126"
},
{
"num": 28,
"question_en": "In the sequence: 81, 27, 9, 3, 1, what is the 3rd number?",
"question_hi": "अनुक्रम: 81, 27, 9, 3, 1 में, तीसरी संख्या क्या है?",
"options_en": ["9", "27", "3", "1"],
"options_hi": ["9", "27", "3", "1"],
"answer_en": "9",
"answer_hi": "9"
},
{
"num": 29,
"question_en": "What is the middle consonant in 'PRONUNCIATION'?",
"question_hi": "'PRONUNCIATION' में मध्य व्यंजन क्या है?",
"options_en": ["N", "C", "T", "P"],
"options_hi": ["N", "C", "T", "P"],
"answer_en": "N",
"answer_hi": "N"
},
{
"num": 30,
"question_en": "In the series: 9, 18, 27, 36, 45, what is 4th number divided by 2nd number?",
"question_hi": "श्रृंखला: 9, 18, 27, 36, 45 में, चौथी संख्या को दूसरी संख्या से भाग देने पर क्या मिलता है?",
"options_en": ["2", "1.5", "3", "2.5"],
"options_hi": ["2", "1.5", "3", "2.5"],
"answer_en": "2",
"answer_hi": "2"
},
{
"num": 31,
"question_en": "What is the difference between 4th and 1st letters in 'HIBERNATION'?",
"question_hi": "'HIBERNATION' में चौथे और पहले अक्षर में क्या अंतर है?",
"options_en": ["E and H", "B and H", "R and H", "N and H"],
"options_hi": ["E और H", "B और H", "R और H", "N और H"],
"answer_en": "E and H",
"answer_hi": "E और H"
},
{
"num": 32,
"question_en": "In the pattern: 12, 24, 36, 48, 60, what comes next?",
"question_hi": "पैटर्न: 12, 24, 36, 48, 60 में, आगे क्या आता है?",
"options_en": ["72", "66", "84", "78"],
"options_hi": ["72", "66", "84", "78"],
"answer_en": "72",
"answer_hi": "72"
},
{
"num": 33,
"question_en": "What is the product of positions of vowels in 'ALPHABET'?",
"question_hi": "'ALPHABET' में स्वरों की स्थितियों का गुणनफल क्या है?",
"options_en": ["20", "24", "30", "15"],
"options_hi": ["20", "24", "30", "15"],
"answer_en": "20",
"answer_hi": "20"
},
{
"num": 34,
"question_en": "In 'DISSERTATION', how many letters before second 'S'?",
"question_hi": "'DISSERTATION' में, दूसरे 'S' से पहले कितने अक्षर हैं?",
"options_en": ["2", "3", "4", "5"],
"options_hi": ["2", "3", "4", "5"],
"answer_en": "2",
"answer_hi": "2"
},
{
"num": 35,
"question_en": "What is the average of 2nd and 7th perfect squares?",
"question_hi": "दूसरे और सातवें पूर्ण वर्गों का औसत क्या है?",
"options_en": ["27.5", "25", "30", "32.5"],
"options_hi": ["27.5", "25", "30", "32.5"],
"answer_en": "27.5",
"answer_hi": "27.5"
},
{
"num": 36,
"question_en": "In the pattern: 7, 49, 343, 2401, what is the 3rd number?",
"question_hi": "पैटर्न: 7, 49, 343, 2401 में, तीसरी संख्या क्या है?",
"options_en": ["343", "49", "2401", "16807"],
"options_hi": ["343", "49", "2401", "16807"],
"answer_en": "343",
"answer_hi": "343"
},
{
"num": 37,
"question_en": "What is the sum of positions of 'G' in 'GOVERNING'?",
"question_hi": "'GOVERNING' में 'G' की स्थितियों का योग क्या है?",
"options_en": ["9", "10", "8", "11"],
"options_hi": ["9", "10", "8", "11"],
"answer_en": "9",
"answer_hi": "9"
},
{
"num": 38,
"question_en": "In the series: 0.4, 0.8, 1.2, 1.6, 2.0, what is the 5th number?",
"question_hi": "श्रृंखला: 0.4, 0.8, 1.2, 1.6, 2.0 में, पांचवीं संख्या क्या है?",
"options_en": ["2.0", "1.6", "1.2", "0.8"],
"options_hi": ["2.0", "1.6", "1.2", "0.8"],
"answer_en": "2.0",
"answer_hi": "2.0"
},
{
"num": 39,
"question_en": "Which letter is exactly between D and M in alphabet?",
"question_hi": "वर्णमाला में D और M के ठीक बीच में कौन सा अक्षर है?",
"options_en": ["H", "G", "I", "J"],
"options_hi": ["H", "G", "I", "J"],
"answer_en": "H",
"answer_hi": "H"
},
{
"num": 40,
"question_en": "What is the product of 1st and 4th prime numbers: 2, 3, 5, 7, 11?",
"question_hi": "पहली और चौथी अभाज्य संख्याओं का गुणनफल: 2, 3, 5, 7, 11 क्या है?",
"options_en": ["14", "6", "35", "22"],
"options_hi": ["14", "6", "35", "22"],
"answer_en": "14",
"answer_hi": "14"
},
{
"num": 41,
"question_en": "In 'ILLUSTRATION', what is the position of second 'L' from right?",
"question_hi": "'ILLUSTRATION' में, दाएं से दूसरे 'L' की स्थिति क्या है?",
"options_en": ["8", "9", "10", "11"],
"options_hi": ["8", "9", "10", "11"],
"answer_en": "8",
"answer_hi": "8"
},
{
"num": 42,
"question_en": "What is the difference between 5th and 3rd cubes: 1, 8, 27, 64, 125?",
"question_hi": "पांचवें और तीसरे घनों में अंतर: 1, 8, 27, 64, 125 क्या है?",
"options_en": ["98", "91", "117", "37"],
"options_hi": ["98", "91", "117", "37"],
"answer_en": "98",
"answer_hi": "98"
},
{
"num": 43,
"question_en": "In the pattern: 3+4=7, 4+5=9, 5+6=11, 6+7=13, what comes next?",
"question_hi": "पैटर्न: 3+4=7, 4+5=9, 5+6=11, 6+7=13 में, आगे क्या आता है?",
"options_en": ["7+8=15", "8+9=17", "7+9=16", "6+8=14"],
"options_hi": ["7+8=15", "8+9=17", "7+9=16", "6+8=14"],
"answer_en": "7+8=15",
"answer_hi": "7+8=15"
},
{
"num": 44,
"question_en": "What is the average of first five natural numbers?",
"question_hi": "पहली पांच प्राकृतिक संख्याओं का औसत क्या है?",
"options_en": ["3", "2.5", "4", "5"],
"options_hi": ["3", "2.5", "4", "5"],
"answer_en": "3",
"answer_hi": "3"
},
{
"num": 45,
"question_en": "In 'EXCEPTIONAL', how many consonants are there?",
"question_hi": "'EXCEPTIONAL' में कितने व्यंजन हैं?",
"options_en": ["6", "5", "7", "4"],
"options_hi": ["6", "5", "7", "4"],
"answer_en": "6",
"answer_hi": "6"
},
{
"num": 46,
"question_en": "What is the sum of 3rd and 6th triangular numbers: 1, 3, 6, 10, 15, 21?",
"question_hi": "तीसरी और छठी त्रिभुज संख्याओं का योग: 1, 3, 6, 10, 15, 21 क्या है?",
"options_en": ["27", "25", "30", "31"],
"options_hi": ["27", "25", "30", "31"],
"answer_en": "27",
"answer_hi": "27"
},
{
"num": 47,
"question_en": "In the series: 11, 22, 33, 44, 55, what is 3rd number plus 5th number?",
"question_hi": "श्रृंखला: 11, 22, 33, 44, 55 में, तीसरी संख्या जमा पांचवीं संख्या क्या है?",
"options_en": ["88", "77", "99", "66"],
"options_hi": ["88", "77", "99", "66"],
"answer_en": "88",
"answer_hi": "88"
},
{
"num": 48,
"question_en": "What is the position of 'E' in 'EVERGREEN' from right?",
"question_hi": "'EVERGREEN' में दायें से 'E' की स्थिति क्या है?",
"options_en": ["3", "2", "4", "5"],
"options_hi": ["3", "2", "4", "5"],
"answer_en": "3",
"answer_hi": "3"
},
{
"num": 49,
"question_en": "In the pattern: C, F, I, L, O, what comes next?",
"question_hi": "पैटर्न: C, F, I, L, O में, आगे क्या आता है?",
"options_en": ["R", "Q", "S", "P"],
"options_hi": ["R", "Q", "S", "P"],
"answer_en": "R",
"answer_hi": "R"
},
{
"num": 50,
"question_en": "What is the sum of digits of 2nd number in: 21, 42, 63, 84, 105?",
"question_hi": "21, 42, 63, 84, 105 में दूसरी संख्या के अंकों का योग क्या है?",
"options_en": ["6", "7", "8", "9"],
"options_hi": ["6", "7", "8", "9"],
"answer_en": "6",
"answer_hi": "6"
}];



// --------------------------- GLOBAL VARS -----------------------------
// --------------------------- GLOBAL VARS -----------------------------
let currentQuestion = 0;
let language = "en";
let timeLeft = 60 * 60; 
let timerInterval;

// ----------------- Load Question -----------------
function loadQuestion(index) {
    const q = questions[index];
    if (!q) return; //  undefined error fix

    document.getElementById("question").textContent =
        `${q.num}. ${language === "en" ? q.question_en : q.question_hi}`;

    document.getElementById("questionCounter").textContent =
        `Question ${index + 1} of ${questions.length}`;

    const optionsElement = document.getElementById("options");
    optionsElement.innerHTML = "";

    const options = language === "en" ? q.options_en : q.options_hi;

    options.forEach(option => {
        const isSelected = q.selected === option;

        const div = document.createElement("div");
        div.className = "option-box";

        div.style = `
            border: 2px solid ${isSelected ? "#007bff" : "#ccc"};
            background-color: ${isSelected ? "#e7f1ff" : "white"};
            padding: 10px;
            border-radius: 8px;
            margin: 6px 0;
            cursor: pointer;
        `;

        div.innerHTML = `
            <input type="radio" name="option" value="${option}" 
            ${isSelected ? "checked" : ""} style="margin-right:8px;">
            ${option}
        `;

        div.addEventListener("click", () => {
            markAttempted(index, option);
            loadQuestion(index);
        });

        optionsElement.appendChild(div);
    });

    updateNavigation();
}

// ----------------- Attempt Mark -----------------
function markAttempted(index, selectedAnswer) {
    questions[index].attempted = true;
    questions[index].selected = selectedAnswer;
    updateNavigation();
}

// ----------------- Next / Previous -----------------
function nextQuestion() {
    if (currentQuestion < questions.length - 1) {
        currentQuestion++;
        loadQuestion(currentQuestion);
    }
}

function prevQuestion() {
    if (currentQuestion > 0) {
        currentQuestion--;
        loadQuestion(currentQuestion);
    }
}

function changeLanguage() {
    language = document.getElementById("languageSelect").value;
    loadQuestion(currentQuestion);
}

// ----------------- Final Submit -----------------
function submitQuiz() {
    let confirmation = confirm("Are you sure you want to submit the test?");
    if (!confirmation) return;

    let attempted = 0;
    let notAttempted = 0;
    let score = 0;
    const results = [];

    questions.forEach(q => {
        if (q.attempted) {
            attempted++;

            if (q.selected === q.answer_en || q.selected === q.answer_hi) {
                score++;
            }
        } else {
            notAttempted++;
        }

        results.push({
            question: language === "en" ? q.question_en : q.question_hi,
            selected: q.selected || "Not Answered",
            correct: language === "en" ? q.answer_en : q.answer_hi
        });
    });

    localStorage.setItem("attempted", attempted);
    localStorage.setItem("notAttempted", notAttempted);
    localStorage.setItem("score", score);
    localStorage.setItem("results", JSON.stringify(results));

    let viewResult = confirm("Test submitted! Do you want to view result?");
    if (viewResult) {
        window.location.href = "/RTS/public/Deshbord/category/test/submit-test.html";
    }
}

// ----------------- Navigation Circles -----------------
function updateNavigation() {
    const nav = document.getElementById("circleContainer");
    nav.innerHTML = "";

    questions.forEach((q, i) => {
        let color = "gray";
        if (i === currentQuestion) color = "blue";
        else if (q.attempted) color = "green";

        nav.innerHTML += `
            <div class="circle" style="background:${color};"
            onclick="jumpToQuestion(${i})">${i + 1}</div>
        `;
    });
}

function jumpToQuestion(index) {
    currentQuestion = index;
    loadQuestion(index);
}

// ----------------- Timer -----------------
function startTimer() {
    const timerElement = document.getElementById("timer");

    timerInterval = setInterval(() => {
        if (timeLeft <= 0) {
            clearInterval(timerInterval);
            alert("Time's up!");
            submitQuiz();
        } else {
            const hours = String(Math.floor(timeLeft / 3600)).padStart(2, "0");
            const minutes = String(Math.floor((timeLeft % 3600) / 60)).padStart(2, "0");
            const seconds = String(timeLeft % 60).padStart(2, "0");

            timerElement.textContent = `Time Left: ${hours}:${minutes}:${seconds}`;
            timeLeft--;
        }
    }, 1000);
}

// ----------------- Camera & Movement Detection -----------------
let videoStream;
let movementCount = 0;

function startCamera() {
    const container = document.createElement("div");
    container.id = "camera-container";
    container.style = `
        position:fixed; top:10px; left:10px; width:130px; height:130px;
        border-radius:50%; overflow:hidden; border:3px solid red; z-index:9999;
    `;

    document.body.appendChild(container);

    const video = document.createElement("video");
    video.autoplay = true;
    video.playsinline = true;
    video.style = "width:100%; height:100%; object-fit:cover;";
    container.appendChild(video);

    navigator.mediaDevices.getUserMedia({ video: true })
        .then(stream => {
            video.srcObject = stream;
            videoStream = stream;
            detectMovement(video);
        })
        .catch(() => alert("Camera access denied!"));
}

function detectMovement(video) {
    const canvas = document.createElement("canvas");
    const ctx = canvas.getContext("2d");
    canvas.width = 160;
    canvas.height = 160;

    let lastData = null;

    setInterval(() => {
        ctx.drawImage(video, 0, 0, 160, 160);
        const data = ctx.getImageData(0, 0, 160, 160);

        if (lastData) {
            let diff = 0;
            for (let i = 0; i < data.data.length; i += 4) {
                diff += Math.abs(data.data[i] - lastData.data[i]);
            }

            if (diff > 1000000) {
                movementCount++;

                if (movementCount === 1) alert("⚠ Alert 1: No movement detected!");
                if (movementCount === 2) alert("⚠ Alert 2: Head not moving!");
                if (movementCount === 3) {
                    alert("⚠ Alert 3: Restarting test...");
                    restartTest();
                }
            }
        }
        lastData = data;

    }, 2000);
}

function restartTest() {
    if (videoStream) videoStream.getTracks().forEach(t => t.stop());

    const cam = document.getElementById("camera-container");
    if (cam) cam.remove();

    movementCount = 0;
    currentQuestion = 0;
    timeLeft = 60 * 60;

    questions.forEach(q => {
        q.attempted = false;
        q.selected = null;
    });

    loadQuestion(0);
    startTimer();
    startCamera();
}

// ----------------- Page Load -----------------
window.onload = function () {
    loadQuestion(currentQuestion);
    startTimer();
    startCamera();
};