const questions =[{
"num": 1,
"question_en": "In the word 'EXAGGERATION', what is the 5th letter from the right?",
"question_hi": "'EXAGGERATION' शब्द में दाएं से 5वां अक्षर क्या है?",
"options_en": ["R", "A", "T", "E"],
"options_hi": ["R", "A", "T", "E"],
"answer_en": "R",
"answer_hi": "R"
},
{
"num": 2,
"question_en": "What is the sum of 2nd and 4th numbers in the sequence: 15, 30, 45, 60, 75?",
"question_hi": "अनुक्रम: 15, 30, 45, 60, 75 में दूसरी और चौथी संख्या का योग क्या है?",
"options_en": ["90", "105", "120", "75"],
"options_hi": ["90", "105", "120", "75"],
"answer_en": "90",
"answer_hi": "90"
},
{
"num": 3,
"question_en": "In the pattern: A2, B4, C6, D8, what comes next?",
"question_hi": "पैटर्न: A2, B4, C6, D8 में, आगे क्या आता है?",
"options_en": ["E10", "F12", "E12", "D10"],
"options_hi": ["E10", "F12", "E12", "D10"],
"answer_en": "E10",
"answer_hi": "E10"
},
{
"num": 4,
"question_en": "What is the middle number in the list: 121, 144, 169, 196, 225?",
"question_hi": "सूची: 121, 144, 169, 196, 225 में मध्य संख्या क्या है?",
"options_en": ["169", "144", "196", "225"],
"options_hi": ["169", "144", "196", "225"],
"answer_en": "169",
"answer_hi": "169"
},
{
"num": 5,
"question_en": "In 'REFERENDUM', what is the position of the second 'E' from the left?",
"question_hi": "'REFERENDUM' में, बाएं से दूसरे 'E' की स्थिति क्या है?",
"options_en": ["3", "4", "5", "6"],
"options_hi": ["3", "4", "5", "6"],
"answer_en": "3",
"answer_hi": "3"
},
{
"num": 6,
"question_en": "What is the product of 3rd and 5th even numbers starting from 2?",
"question_hi": "2 से शुरू होने वाली तीसरी और पांचवीं सम संख्याओं का गुणनफल क्या है?",
"options_en": ["60", "48", "72", "84"],
"options_hi": ["60", "48", "72", "84"],
"answer_en": "60",
"answer_hi": "60"
},
{
"num": 7,
"question_en": "In the series: 0.2, 0.4, 0.6, 0.8, 1.0, what is the 4th number multiplied by 5?",
"question_hi": "श्रृंखला: 0.2, 0.4, 0.6, 0.8, 1.0 में, चौथी संख्या को 5 से गुणा करने पर क्या मिलता है?",
"options_en": ["4", "3", "5", "2"],
"options_hi": ["4", "3", "5", "2"],
"answer_en": "4",
"answer_hi": "4"
},
{
"num": 8,
"question_en": "What is the difference between 4th and 1st multiples of 11: 11, 22, 33, 44, 55?",
"question_hi": "11 के चौथे और पहले गुणजों में अंतर: 11, 22, 33, 44, 55 क्या है?",
"options_en": ["33", "22", "44", "11"],
"options_hi": ["33", "22", "44", "11"],
"answer_en": "33",
"answer_hi": "33"
},
{
"num": 9,
"question_en": "In the word 'ACCOMMODATION', which letter appears 4th time?",
"question_hi": "'ACCOMMODATION' शब्द में, कौन सा अक्षर चौथी बार आता है?",
"options_en": ["O", "C", "M", "A"],
"options_hi": ["O", "C", "M", "A"],
"answer_en": "O",
"answer_hi": "O"
},
{
"num": 10,
"question_en": "What is the average of 2nd and 5th square numbers: 1, 4, 9, 16, 25?",
"question_hi": "दूसरी और पांचवीं वर्ग संख्याओं का औसत: 1, 4, 9, 16, 25 क्या है?",
"options_en": ["14.5", "12.5", "15", "13"],
"options_hi": ["14.5", "12.5", "15", "13"],
"answer_en": "14.5",
"answer_hi": "14.5"
},
{
"num": 11,
"question_en": "In the pattern: X1, Y2, Z3, A4, what comes next?",
"question_hi": "पैटर्न: X1, Y2, Z3, A4 में, आगे क्या आता है?",
"options_en": ["B5", "C6", "B6", "A5"],
"options_hi": ["B5", "C6", "B6", "A5"],
"answer_en": "B5",
"answer_hi": "B5"
},
{
"num": 12,
"question_en": "What is the sum of positions of 'T' in 'TATTLETALE'?",
"question_hi": "'TATTLETALE' में 'T' की स्थितियों का योग क्या है?",
"options_en": ["18", "19", "20", "21"],
"options_hi": ["18", "19", "20", "21"],
"answer_en": "18",
"answer_hi": "18"
},
{
"num": 13,
"question_en": "In the sequence: 2/5, 3/6, 4/7, 5/8, what comes next?",
"question_hi": "अनुक्रम: 2/5, 3/6, 4/7, 5/8 में, आगे क्या आता है?",
"options_en": ["6/9", "7/10", "5/9", "6/10"],
"options_hi": ["6/9", "7/10", "5/9", "6/10"],
"answer_en": "6/9",
"answer_hi": "6/9"
},
{
"num": 14,
"question_en": "What is the middle vowel in 'AUTHORIZATION'?",
"question_hi": "'AUTHORIZATION' में मध्य स्वर क्या है?",
"options_en": ["I", "O", "A", "U"],
"options_hi": ["I", "O", "A", "U"],
"answer_en": "I",
"answer_hi": "I"
},
{
"num": 15,
"question_en": "In the series: 8, 16, 24, 32, 40, what is 62.5% of 4th number?",
"question_hi": "श्रृंखला: 8, 16, 24, 32, 40 में, चौथी संख्या का 62.5% क्या है?",
"options_en": ["20", "24", "16", "25"],
"options_hi": ["20", "24", "16", "25"],
"answer_en": "20",
"answer_hi": "20"
},
{
"num": 16,
"question_en": "Which letter is exactly between G and O in alphabet?",
"question_hi": "वर्णमाला में G और O के ठीक बीच में कौन सा अक्षर है?",
"options_en": ["K", "J", "L", "M"],
"options_hi": ["K", "J", "L", "M"],
"answer_en": "K",
"answer_hi": "K"
},
{
"num": 17,
"question_en": "What is the product of 2nd and 3rd prime numbers after 20?",
"question_hi": "20 के बाद दूसरी और तीसरी अभाज्य संख्याओं का गुणनफल क्या है?",
"options_en": ["667", "713", "779", "629"],
"options_hi": ["667", "713", "779", "629"],
"answer_en": "667",
"answer_hi": "667"
},
{
"num": 18,
"question_en": "In 'MISSPELLING', how many letters between first and last 'S'?",
"question_hi": "'MISSPELLING' में, पहले और अंतिम 'S' के बीच कितने अक्षर हैं?",
"options_en": ["4", "5", "6", "3"],
"options_hi": ["4", "5", "6", "3"],
"answer_en": "4",
"answer_hi": "4"
},
{
"num": 19,
"question_en": "What is the difference between 5th and 2nd triangular numbers: 1, 3, 6, 10, 15?",
"question_hi": "पांचवीं और दूसरी त्रिभुज संख्याओं में अंतर: 1, 3, 6, 10, 15 क्या है?",
"options_en": ["12", "9", "13", "10"],
"options_hi": ["12", "9", "13", "10"],
"answer_en": "12",
"answer_hi": "12"
},
{
"num": 20,
"question_en": "In the pattern: 3, 9, 27, 81, what is the next number?",
"question_hi": "पैटर्न: 3, 9, 27, 81 में, अगली संख्या क्या है?",
"options_en": ["243", "162", "324", "243"],
"options_hi": ["243", "162", "324", "243"],
"answer_en": "243",
"answer_hi": "243"
},
{
"num": 21,
"question_en": "What is the sum of digits of 4th number in: 23, 45, 67, 89, 101?",
"question_hi": "23, 45, 67, 89, 101 में चौथी संख्या के अंकों का योग क्या है?",
"options_en": ["17", "16", "18", "15"],
"options_hi": ["17", "16", "18", "15"],
"answer_en": "17",
"answer_hi": "17"
},
{
"num": 22,
"question_en": "In the series: 1.5, 3.0, 4.5, 6.0, 7.5, what is the 3rd number?",
"question_hi": "श्रृंखला: 1.5, 3.0, 4.5, 6.0, 7.5 में, तीसरी संख्या क्या है?",
"options_en": ["4.5", "3.0", "6.0", "7.5"],
"options_hi": ["4.5", "3.0", "6.0", "7.5"],
"answer_en": "4.5",
"answer_hi": "4.5"
},
{
"num": 23,
"question_en": "What is the position of third 'I' in 'INITIALIZATION'?",
"question_hi": "'INITIALIZATION' में तीसरे 'I' की स्थिति क्या है?",
"options_en": ["9", "8", "10", "11"],
"options_hi": ["9", "8", "10", "11"],
"answer_en": "9",
"answer_hi": "9"
},
{
"num": 24,
"question_en": "In the pattern: 1, 11, 111, 1111, what comes next?",
"question_hi": "पैटर्न: 1, 11, 111, 1111 में, आगे क्या आता है?",
"options_en": ["11111", "111111", "11111", "1111"],
"options_hi": ["11111", "111111", "11111", "1111"],
"answer_en": "11111",
"answer_hi": "11111"
},
{
"num": 25,
"question_en": "What is the average of first three multiples of 9?",
"question_hi": "9 के पहले तीन गुणजों का औसत क्या है?",
"options_en": ["18", "9", "27", "12"],
"options_hi": ["18", "9", "27", "12"],
"answer_en": "18",
"answer_hi": "18"
},
{
"num": 26,
"question_en": "In 'BIBLIOGRAPHY', which consonant appears 5th?",
"question_hi": "'BIBLIOGRAPHY' में, कौन सा व्यंजन 5वां आता है?",
"options_en": ["G", "B", "L", "P"],
"options_hi": ["G", "B", "L", "P"],
"answer_en": "G",
"answer_hi": "G"
},
{
"num": 27,
"question_en": "What is the sum of 3rd and 4th cubes: 1, 8, 27, 64, 125?",
"question_hi": "तीसरे और चौथे घनों का योग: 1, 8, 27, 64, 125 क्या है?",
"options_en": ["91", "99", "125", "152"],
"options_hi": ["91", "99", "125", "152"],
"answer_en": "91",
"answer_hi": "91"
},
{
"num": 28,
"question_en": "In the sequence: 64, 32, 16, 8, 4, what is the 4th number?",
"question_hi": "अनुक्रम: 64, 32, 16, 8, 4 में, चौथी संख्या क्या है?",
"options_en": ["8", "16", "4", "32"],
"options_hi": ["8", "16", "4", "32"],
"answer_en": "8",
"answer_hi": "8"
},
{
"num": 29,
"question_en": "What is the middle consonant in 'ENCYCLOPEDIA'?",
"question_hi": "'ENCYCLOPEDIA' में मध्य व्यंजन क्या है?",
"options_en": ["L", "C", "P", "D"],
"options_hi": ["L", "C", "P", "D"],
"answer_en": "L",
"answer_hi": "L"
},
{
"num": 30,
"question_en": "In the series: 4, 12, 36, 108, 324, what is 3rd number divided by 2nd number?",
"question_hi": "श्रृंखला: 4, 12, 36, 108, 324 में, तीसरी संख्या को दूसरी संख्या से भाग देने पर क्या मिलता है?",
"options_en": ["3", "2", "4", "6"],
"options_hi": ["3", "2", "4", "6"],
"answer_en": "3",
"answer_hi": "3"
},
{
"num": 31,
"question_en": "What is the difference between 5th and 3rd letters in 'QUARANTINE'?",
"question_hi": "'QUARANTINE' में पांचवें और तीसरे अक्षर में क्या अंतर है?",
"options_en": ["R and R", "A and R", "N and R", "T and R"],
"options_hi": ["R और R", "A और R", "N और R", "T और R"],
"answer_en": "R and R",
"answer_hi": "R और R"
},
{
"num": 32,
"question_en": "In the pattern: 10, 20, 30, 40, 50, what comes next?",
"question_hi": "पैटर्न: 10, 20, 30, 40, 50 में, आगे क्या आता है?",
"options_en": ["60", "70", "55", "65"],
"options_hi": ["60", "70", "55", "65"],
"answer_en": "60",
"answer_hi": "60"
},
{
"num": 33,
"question_en": "What is the product of positions of consonants in 'WORD'?",
"question_hi": "'WORD' में व्यंजनों की स्थितियों का गुणनफल क्या है?",
"options_en": ["18", "12", "24", "6"],
"options_hi": ["18", "12", "24", "6"],
"answer_en": "18",
"answer_hi": "18"
},
{
"num": 34,
"question_en": "In 'EXHIBITION', how many letters after first 'I'?",
"question_hi": "'EXHIBITION' में, पहले 'I' के बाद कितने अक्षर हैं?",
"options_en": ["7", "6", "8", "9"],
"options_hi": ["7", "6", "8", "9"],
"answer_en": "7",
"answer_hi": "7"
},
{
"num": 35,
"question_en": "What is the average of 3rd and 6th perfect squares?",
"question_hi": "तीसरे और छठे पूर्ण वर्गों का औसत क्या है?",
"options_en": ["22.5", "20", "25", "27.5"],
"options_hi": ["22.5", "20", "25", "27.5"],
"answer_en": "22.5",
"answer_hi": "22.5"
},
{
"num": 36,
"question_en": "In the pattern: 5, 25, 125, 625, what is the 3rd number?",
"question_hi": "पैटर्न: 5, 25, 125, 625 में, तीसरी संख्या क्या है?",
"options_en": ["125", "25", "625", "3125"],
"options_hi": ["125", "25", "625", "3125"],
"answer_en": "125",
"answer_hi": "125"
},
{
"num": 37,
"question_en": "What is the sum of positions of 'L' in 'LEVELHEADED'?",
"question_hi": "'LEVELHEADED' में 'L' की स्थितियों का योग क्या है?",
"options_en": ["6", "5", "7", "8"],
"options_hi": ["6", "5", "7", "8"],
"answer_en": "6",
"answer_hi": "6"
},
{
"num": 38,
"question_en": "In the series: 100, 50, 25, 12.5, 6.25, what is the 4th number?",
"question_hi": "श्रृंखला: 100, 50, 25, 12.5, 6.25 में, चौथी संख्या क्या है?",
"options_en": ["12.5", "25", "6.25", "50"],
"options_hi": ["12.5", "25", "6.25", "50"],
"answer_en": "12.5",
"answer_hi": "12.5"
},
{
"num": 39,
"question_en": "Which letter is exactly between J and P in alphabet?",
"question_hi": "वर्णमाला में J और P के ठीक बीच में कौन सा अक्षर है?",
"options_en": ["M", "L", "N", "O"],
"options_hi": ["M", "L", "N", "O"],
"answer_en": "M",
"answer_hi": "M"
},
{
"num": 40,
"question_en": "What is the product of 3rd and 5th prime numbers: 2, 3, 5, 7, 11?",
"question_hi": "तीसरी और पांचवीं अभाज्य संख्याओं का गुणनफल: 2, 3, 5, 7, 11 क्या है?",
"options_en": ["55", "35", "77", "25"],
"options_hi": ["55", "35", "77", "25"],
"answer_en": "55",
"answer_hi": "55"
},
{
"num": 41,
"question_en": "In 'ILLUMINATION', what is the position of second 'I' from right?",
"question_hi": "'ILLUMINATION' में, दाएं से दूसरे 'I' की स्थिति क्या है?",
"options_en": ["4", "5", "6", "7"],
"options_hi": ["4", "5", "6", "7"],
"answer_en": "4",
"answer_hi": "4"
},
{
"num": 42,
"question_en": "What is the difference between 4th and 2nd cubes: 1, 8, 27, 64, 125?",
"question_hi": "चौथे और दूसरे घनों में अंतर: 1, 8, 27, 64, 125 क्या है?",
"options_en": ["56", "36", "48", "27"],
"options_hi": ["56", "36", "48", "27"],
"answer_en": "56",
"answer_hi": "56"
},
{
"num": 43,
"question_en": "In the pattern: 2×3=6, 3×4=12, 4×5=20, 5×6=30, what comes next?",
"question_hi": "पैटर्न: 2×3=6, 3×4=12, 4×5=20, 5×6=30 में, आगे क्या आता है?",
"options_en": ["6×7=42", "7×8=56", "6×8=48", "5×7=35"],
"options_hi": ["6×7=42", "7×8=56", "6×8=48", "5×7=35"],
"answer_en": "6×7=42",
"answer_hi": "6×7=42"
},
{
"num": 44,
"question_en": "What is the average of first three even numbers?",
"question_hi": "पहली तीन सम संख्याओं का औसत क्या है?",
"options_en": ["4", "3", "5", "6"],
"options_hi": ["4", "3", "5", "6"],
"answer_en": "4",
"answer_hi": "4"
},
{
"num": 45,
"question_en": "In 'CHRONOLOGICAL', how many vowels are there?",
"question_hi": "'CHRONOLOGICAL' में कितने स्वर हैं?",
"options_en": ["5", "4", "6", "3"],
"options_hi": ["5", "4", "6", "3"],
"answer_en": "5",
"answer_hi": "5"
},
{
"num": 46,
"question_en": "What is the sum of 4th and 5th triangular numbers: 1, 3, 6, 10, 15?",
"question_hi": "चौथी और पांचवीं त्रिभुज संख्याओं का योग: 1, 3, 6, 10, 15 क्या है?",
"options_en": ["25", "21", "24", "30"],
"options_hi": ["25", "21", "24", "30"],
"answer_en": "25",
"answer_hi": "25"
},
{
"num": 47,
"question_en": "In the series: 1, 4, 9, 16, 25, what is 3rd number minus 2nd number?",
"question_hi": "श्रृंखला: 1, 4, 9, 16, 25 में, तीसरी संख्या घटा दूसरी संख्या क्या है?",
"options_en": ["5", "3", "7", "9"],
"options_hi": ["5", "3", "7", "9"],
"answer_en": "5",
"answer_hi": "5"
},
{
"num": 48,
"question_en": "What is the position of 'A' in 'ANALYSIS' from right?",
"question_hi": "'ANALYSIS' में दायें से 'A' की स्थिति क्या है?",
"options_en": ["7", "6", "8", "5"],
"options_hi": ["7", "6", "8", "5"],
"answer_en": "7",
"answer_hi": "7"
},
{
"num": 49,
"question_en": "In the pattern: B, D, F, H, J, what comes next?",
"question_hi": "पैटर्न: B, D, F, H, J में, आगे क्या आता है?",
"options_en": ["L", "K", "M", "N"],
"options_hi": ["L", "K", "M", "N"],
"answer_en": "L",
"answer_hi": "L"
},
{
"num": 50,
"question_en": "What is the sum of digits of 3rd number in: 12, 34, 56, 78, 90?",
"question_hi": "12, 34, 56, 78, 90 में तीसरी संख्या के अंकों का योग क्या है?",
"options_en": ["11", "10", "12", "9"],
"options_hi": ["11", "10", "12", "9"],
"answer_en": "11",
"answer_hi": "11"
}];



// --------------------------- GLOBAL VARS -----------------------------
// --------------------------- GLOBAL VARS -----------------------------
let currentQuestion = 0;
let language = "en";
let timeLeft = 60 * 60; 
let timerInterval;

// ----------------- Load Question -----------------
function loadQuestion(index) {
    const q = questions[index];
    if (!q) return; //  undefined error fix

    document.getElementById("question").textContent =
        `${q.num}. ${language === "en" ? q.question_en : q.question_hi}`;

    document.getElementById("questionCounter").textContent =
        `Question ${index + 1} of ${questions.length}`;

    const optionsElement = document.getElementById("options");
    optionsElement.innerHTML = "";

    const options = language === "en" ? q.options_en : q.options_hi;

    options.forEach(option => {
        const isSelected = q.selected === option;

        const div = document.createElement("div");
        div.className = "option-box";

        div.style = `
            border: 2px solid ${isSelected ? "#007bff" : "#ccc"};
            background-color: ${isSelected ? "#e7f1ff" : "white"};
            padding: 10px;
            border-radius: 8px;
            margin: 6px 0;
            cursor: pointer;
        `;

        div.innerHTML = `
            <input type="radio" name="option" value="${option}" 
            ${isSelected ? "checked" : ""} style="margin-right:8px;">
            ${option}
        `;

        div.addEventListener("click", () => {
            markAttempted(index, option);
            loadQuestion(index);
        });

        optionsElement.appendChild(div);
    });

    updateNavigation();
}

// ----------------- Attempt Mark -----------------
function markAttempted(index, selectedAnswer) {
    questions[index].attempted = true;
    questions[index].selected = selectedAnswer;
    updateNavigation();
}

// ----------------- Next / Previous -----------------
function nextQuestion() {
    if (currentQuestion < questions.length - 1) {
        currentQuestion++;
        loadQuestion(currentQuestion);
    }
}

function prevQuestion() {
    if (currentQuestion > 0) {
        currentQuestion--;
        loadQuestion(currentQuestion);
    }
}

function changeLanguage() {
    language = document.getElementById("languageSelect").value;
    loadQuestion(currentQuestion);
}

// ----------------- Final Submit -----------------
function submitQuiz() {
    let confirmation = confirm("Are you sure you want to submit the test?");
    if (!confirmation) return;

    let attempted = 0;
    let notAttempted = 0;
    let score = 0;
    const results = [];

    questions.forEach(q => {
        if (q.attempted) {
            attempted++;

            if (q.selected === q.answer_en || q.selected === q.answer_hi) {
                score++;
            }
        } else {
            notAttempted++;
        }

        results.push({
            question: language === "en" ? q.question_en : q.question_hi,
            selected: q.selected || "Not Answered",
            correct: language === "en" ? q.answer_en : q.answer_hi
        });
    });

    localStorage.setItem("attempted", attempted);
    localStorage.setItem("notAttempted", notAttempted);
    localStorage.setItem("score", score);
    localStorage.setItem("results", JSON.stringify(results));

    let viewResult = confirm("Test submitted! Do you want to view result?");
    if (viewResult) {
        window.location.href = "/RTS/public/Deshbord/category/test/submit-test.html";
    }
}

// ----------------- Navigation Circles -----------------
function updateNavigation() {
    const nav = document.getElementById("circleContainer");
    nav.innerHTML = "";

    questions.forEach((q, i) => {
        let color = "gray";
        if (i === currentQuestion) color = "blue";
        else if (q.attempted) color = "green";

        nav.innerHTML += `
            <div class="circle" style="background:${color};"
            onclick="jumpToQuestion(${i})">${i + 1}</div>
        `;
    });
}

function jumpToQuestion(index) {
    currentQuestion = index;
    loadQuestion(index);
}

// ----------------- Timer -----------------
function startTimer() {
    const timerElement = document.getElementById("timer");

    timerInterval = setInterval(() => {
        if (timeLeft <= 0) {
            clearInterval(timerInterval);
            alert("Time's up!");
            submitQuiz();
        } else {
            const hours = String(Math.floor(timeLeft / 3600)).padStart(2, "0");
            const minutes = String(Math.floor((timeLeft % 3600) / 60)).padStart(2, "0");
            const seconds = String(timeLeft % 60).padStart(2, "0");

            timerElement.textContent = `Time Left: ${hours}:${minutes}:${seconds}`;
            timeLeft--;
        }
    }, 1000);
}

// ----------------- Camera & Movement Detection -----------------
let videoStream;
let movementCount = 0;

function startCamera() {
    const container = document.createElement("div");
    container.id = "camera-container";
    container.style = `
        position:fixed; top:10px; left:10px; width:130px; height:130px;
        border-radius:50%; overflow:hidden; border:3px solid red; z-index:9999;
    `;

    document.body.appendChild(container);

    const video = document.createElement("video");
    video.autoplay = true;
    video.playsinline = true;
    video.style = "width:100%; height:100%; object-fit:cover;";
    container.appendChild(video);

    navigator.mediaDevices.getUserMedia({ video: true })
        .then(stream => {
            video.srcObject = stream;
            videoStream = stream;
            detectMovement(video);
        })
        .catch(() => alert("Camera access denied!"));
}

function detectMovement(video) {
    const canvas = document.createElement("canvas");
    const ctx = canvas.getContext("2d");
    canvas.width = 160;
    canvas.height = 160;

    let lastData = null;

    setInterval(() => {
        ctx.drawImage(video, 0, 0, 160, 160);
        const data = ctx.getImageData(0, 0, 160, 160);

        if (lastData) {
            let diff = 0;
            for (let i = 0; i < data.data.length; i += 4) {
                diff += Math.abs(data.data[i] - lastData.data[i]);
            }

            if (diff > 1000000) {
                movementCount++;

                if (movementCount === 1) alert("⚠ Alert 1: No movement detected!");
                if (movementCount === 2) alert("⚠ Alert 2: Head not moving!");
                if (movementCount === 3) {
                    alert("⚠ Alert 3: Restarting test...");
                    restartTest();
                }
            }
        }
        lastData = data;

    }, 2000);
}

function restartTest() {
    if (videoStream) videoStream.getTracks().forEach(t => t.stop());

    const cam = document.getElementById("camera-container");
    if (cam) cam.remove();

    movementCount = 0;
    currentQuestion = 0;
    timeLeft = 60 * 60;

    questions.forEach(q => {
        q.attempted = false;
        q.selected = null;
    });

    loadQuestion(0);
    startTimer();
    startCamera();
}

// ----------------- Page Load -----------------
window.onload = function () {
    loadQuestion(currentQuestion);
    startTimer();
    startCamera();
};